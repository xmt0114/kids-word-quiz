<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å„¿ç«¥çŒœå•è¯ - æ•°æ®ç®¡ç†å·¥å…·</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Fredoka', sans-serif;
        }
        .bounce {
            animation: bounce 0.6s ease-in-out;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .pulse-ring {
            animation: pulse-ring 1.5s ease-in-out infinite;
        }
        @keyframes pulse-ring {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-100 via-yellow-50 to-pink-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- æ ‡é¢˜ -->
        <div class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">
                ğŸ¯ å„¿ç«¥çŒœå•è¯æ•°æ®ç®¡ç†
            </h1>
            <p class="text-lg text-gray-600">è½»æ¾ç®¡ç†å’Œç¼–è¾‘å•è¯æ•°æ®</p>
        </div>

        <!-- æ“ä½œé¢æ¿ -->
        <div class="bg-white rounded-3xl shadow-lg p-6 mb-8">
            <div class="flex flex-wrap gap-4 justify-center">
                <button id="loadData" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-2xl font-medium transition-all duration-300 transform hover:scale-105">
                    ğŸ“‚ åŠ è½½æ•°æ®
                </button>
                <button id="addWord" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-2xl font-medium transition-all duration-300 transform hover:scale-105">
                    â• æ·»åŠ å•è¯
                </button>
                <button id="validateData" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-2xl font-medium transition-all duration-300 transform hover:scale-105">
                    âœ… éªŒè¯æ•°æ®
                </button>
                <button id="exportData" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-2xl font-medium transition-all duration-300 transform hover:scale-105">
                    ğŸ’¾ å¯¼å‡ºæ•°æ®
                </button>
                <button id="generateSample" class="bg-pink-500 hover:bg-pink-600 text-white px-6 py-3 rounded-2xl font-medium transition-all duration-300 transform hover:scale-105">
                    ğŸ² ç”Ÿæˆç¤ºä¾‹
                </button>
            </div>
        </div>

        <!-- çŠ¶æ€æ˜¾ç¤º -->
        <div id="status" class="bg-white rounded-2xl shadow-lg p-4 mb-6 hidden">
            <div id="statusContent" class="text-center"></div>
        </div>

        <!-- å•è¯åˆ—è¡¨ -->
        <div class="bg-white rounded-3xl shadow-lg p-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">ğŸ“š å•è¯åˆ—è¡¨</h2>
            <div id="wordList" class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
                <!-- å•è¯å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <!-- æ·»åŠ /ç¼–è¾‘å•è¯æ¨¡æ€æ¡† -->
        <div id="wordModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-3xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h3 id="modalTitle" class="text-2xl font-bold text-gray-800">æ·»åŠ æ–°å•è¯</h3>
                    <button id="closeModal" class="text-gray-500 hover:text-gray-700 text-2xl">âœ•</button>
                </div>
                
                <form id="wordForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å•è¯</label>
                        <input type="text" id="wordInput" class="w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ä¾‹å¦‚: brother">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å®šä¹‰ï¼ˆæ–‡å­—é¢˜å¹²ï¼‰</label>
                        <textarea id="definitionInput" class="w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3" placeholder="ä¾‹å¦‚: This boy or man has the same mother and father as you."></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">éŸ³é¢‘æ–‡æœ¬</label>
                        <textarea id="audioTextInput" class="w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3" placeholder="ä¾‹å¦‚: He is a boy. His mother is your mother."></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">éš¾åº¦</label>
                        <select id="difficultyInput" class="w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="easy">ç®€å•</option>
                            <option value="medium">ä¸­ç­‰</option>
                            <option value="hard">å›°éš¾</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">é€‰é¡¹ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰</label>
                        <input type="text" id="optionsInput" class="w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ä¾‹å¦‚: sister, brother, father, uncle">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æ­£ç¡®ç­”æ¡ˆ</label>
                        <input type="text" id="answerInput" class="w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ä¾‹å¦‚: brother">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æç¤º</label>
                        <input type="text" id="hintInput" class="w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ä¾‹å¦‚: B _ _ _ _ _ _">
                    </div>
                    
                    <div class="flex gap-4 pt-4">
                        <button type="submit" class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 rounded-2xl font-medium transition-all duration-300">
                            ğŸ’¾ ä¿å­˜
                        </button>
                        <button type="button" id="cancelBtn" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-2xl font-medium transition-all duration-300">
                            å–æ¶ˆ
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let wordsData = null;
        let editingIndex = -1;

        // DOM å…ƒç´ 
        const elements = {
            loadData: document.getElementById('loadData'),
            addWord: document.getElementById('addWord'),
            validateData: document.getElementById('validateData'),
            exportData: document.getElementById('exportData'),
            generateSample: document.getElementById('generateSample'),
            wordList: document.getElementById('wordList'),
            status: document.getElementById('status'),
            statusContent: document.getElementById('statusContent'),
            wordModal: document.getElementById('wordModal'),
            modalTitle: document.getElementById('modalTitle'),
            closeModal: document.getElementById('closeModal'),
            wordForm: document.getElementById('wordForm'),
            cancelBtn: document.getElementById('cancelBtn'),
            // è¡¨å•è¾“å…¥
            wordInput: document.getElementById('wordInput'),
            definitionInput: document.getElementById('definitionInput'),
            audioTextInput: document.getElementById('audioTextInput'),
            difficultyInput: document.getElementById('difficultyInput'),
            optionsInput: document.getElementById('optionsInput'),
            answerInput: document.getElementById('answerInput'),
            hintInput: document.getElementById('hintInput')
        };

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            loadData();
        });

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            elements.loadData.addEventListener('click', loadData);
            elements.addWord.addEventListener('click', () => openModal());
            elements.validateData.addEventListener('click', validateData);
            elements.exportData.addEventListener('click', exportData);
            elements.generateSample.addEventListener('click', generateSampleData);
            elements.closeModal.addEventListener('click', closeModal);
            elements.cancelBtn.addEventListener('click', closeModal);
            elements.wordForm.addEventListener('submit', saveWord);
            
            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            elements.wordModal.addEventListener('click', function(e) {
                if (e.target === elements.wordModal) {
                    closeModal();
                }
            });
        }

        // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
        function showStatus(message, type = 'info') {
            elements.statusContent.innerHTML = message;
            elements.status.classList.remove('hidden');
            
            const colors = {
                success: 'text-green-600',
                error: 'text-red-600',
                warning: 'text-yellow-600',
                info: 'text-blue-600'
            };
            
            elements.statusContent.className = `text-center ${colors[type]}`;
            
            setTimeout(() => {
                elements.status.classList.add('hidden');
            }, 5000);
        }

        // åŠ è½½æ•°æ®
        async function loadData() {
            try {
                showStatus('ğŸ“‚ æ­£åœ¨åŠ è½½æ•°æ®...', 'info');
                const response = await fetch('/data/words.json');
                wordsData = await response.json();
                renderWordList();
                showStatus('âœ… æ•°æ®åŠ è½½æˆåŠŸï¼', 'success');
            } catch (error) {
                showStatus('âŒ æ•°æ®åŠ è½½å¤±è´¥: ' + error.message, 'error');
            }
        }

        // æ¸²æŸ“å•è¯åˆ—è¡¨
        function renderWordList() {
            if (!wordsData || !wordsData.words) return;
            
            elements.wordList.innerHTML = wordsData.words.map((word, index) => `
                <div class="bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl p-4 border border-gray-200 hover:shadow-lg transition-all duration-300">
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-xl font-bold text-gray-800">${word.word}</h3>
                        <div class="flex gap-2">
                            <button onclick="editWord(${index})" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded-lg text-sm transition-all duration-300">
                                âœï¸ ç¼–è¾‘
                            </button>
                            <button onclick="deleteWord(${index})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-lg text-sm transition-all duration-300">
                                ğŸ—‘ï¸ åˆ é™¤
                            </button>
                        </div>
                    </div>
                    <div class="space-y-2 text-sm text-gray-600">
                        <p><strong>å®šä¹‰:</strong> ${word.definition}</p>
                        <p><strong>éš¾åº¦:</strong> <span class="px-2 py-1 rounded-full text-xs font-medium ${
                            word.difficulty === 'easy' ? 'bg-green-100 text-green-800' :
                            word.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                            'bg-red-100 text-red-800'
                        }">${word.difficulty === 'easy' ? 'ç®€å•' : word.difficulty === 'medium' ? 'ä¸­ç­‰' : 'å›°éš¾'}</span></p>
                        <p><strong>æç¤º:</strong> ${word.hint}</p>
                        <p><strong>é€‰é¡¹:</strong> ${word.options.join(', ')}</p>
                    </div>
                </div>
            `).join('');
        }

        // æ‰“å¼€æ¨¡æ€æ¡†
        function openModal(index = -1) {
            editingIndex = index;
            elements.modalTitle.textContent = index === -1 ? 'æ·»åŠ æ–°å•è¯' : 'ç¼–è¾‘å•è¯';
            
            if (index !== -1 && wordsData.words[index]) {
                const word = wordsData.words[index];
                elements.wordInput.value = word.word;
                elements.definitionInput.value = word.definition;
                elements.audioTextInput.value = word.audioText;
                elements.difficultyInput.value = word.difficulty;
                elements.optionsInput.value = word.options.join(', ');
                elements.answerInput.value = word.answer;
                elements.hintInput.value = word.hint;
            } else {
                elements.wordForm.reset();
            }
            
            elements.wordModal.classList.remove('hidden');
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            elements.wordModal.classList.add('hidden');
            editingIndex = -1;
        }

        // ä¿å­˜å•è¯
        function saveWord(e) {
            e.preventDefault();
            
            const wordData = {
                id: editingIndex === -1 ? (wordsData.words.length + 1) : wordsData.words[editingIndex].id,
                word: elements.wordInput.value.trim(),
                definition: elements.definitionInput.value.trim(),
                audioText: elements.audioTextInput.value.trim(),
                difficulty: elements.difficultyInput.value,
                options: elements.optionsInput.value.split(',').map(opt => opt.trim()).filter(opt => opt),
                answer: elements.answerInput.value.trim(),
                hint: elements.hintInput.value.trim()
            };
            
            // éªŒè¯æ•°æ®
            const errors = validateWordData(wordData);
            if (errors.length > 0) {
                showStatus('âŒ æ•°æ®éªŒè¯å¤±è´¥: ' + errors.join(', '), 'error');
                return;
            }
            
            if (editingIndex === -1) {
                wordsData.words.push(wordData);
                showStatus('âœ… å•è¯æ·»åŠ æˆåŠŸï¼', 'success');
            } else {
                wordsData.words[editingIndex] = wordData;
                showStatus('âœ… å•è¯æ›´æ–°æˆåŠŸï¼', 'success');
            }
            
            renderWordList();
            closeModal();
        }

        // ç¼–è¾‘å•è¯
        function editWord(index) {
            openModal(index);
        }

        // åˆ é™¤å•è¯
        function deleteWord(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå•è¯å—ï¼Ÿ')) {
                wordsData.words.splice(index, 1);
                renderWordList();
                showStatus('âœ… å•è¯åˆ é™¤æˆåŠŸï¼', 'success');
            }
        }

        // éªŒè¯æ•°æ®
        function validateData() {
            if (!wordsData) {
                showStatus('âŒ è¯·å…ˆåŠ è½½æ•°æ®', 'error');
                return;
            }
            
            const errors = [];
            wordsData.words.forEach((word, index) => {
                const wordErrors = validateWordData(word);
                if (wordErrors.length > 0) {
                    errors.push(`ç¬¬${index + 1}ä¸ªå•è¯: ${wordErrors.join(', ')}`);
                }
            });
            
            if (errors.length === 0) {
                showStatus('âœ… æ•°æ®éªŒè¯é€šè¿‡ï¼æ‰€æœ‰å•è¯æ•°æ®éƒ½æ­£ç¡®ã€‚', 'success');
            } else {
                showStatus('âŒ æ•°æ®éªŒè¯å¤±è´¥:\n' + errors.join('\n'), 'error');
            }
        }

        // éªŒè¯å•ä¸ªå•è¯æ•°æ®
        function validateWordData(word) {
            const errors = [];
            
            if (!word.word) errors.push('å•è¯ä¸èƒ½ä¸ºç©º');
            if (!word.definition) errors.push('å®šä¹‰ä¸èƒ½ä¸ºç©º');
            if (!word.audioText) errors.push('éŸ³é¢‘æ–‡æœ¬ä¸èƒ½ä¸ºç©º');
            if (!['easy', 'medium', 'hard'].includes(word.difficulty)) {
                errors.push('éš¾åº¦å¿…é¡»æ˜¯ easyã€medium æˆ– hard');
            }
            if (!Array.isArray(word.options) || word.options.length < 3) {
                errors.push('é€‰é¡¹å¿…é¡»è‡³å°‘åŒ…å«3ä¸ª');
            }
            if (!word.answer) errors.push('ç­”æ¡ˆä¸èƒ½ä¸ºç©º');
            if (word.options && !word.options.includes(word.answer)) {
                errors.push('ç­”æ¡ˆå¿…é¡»åœ¨é€‰é¡¹åˆ—è¡¨ä¸­');
            }
            
            return errors;
        }

        // å¯¼å‡ºæ•°æ®
        function exportData() {
            if (!wordsData) {
                showStatus('âŒ è¯·å…ˆåŠ è½½æ•°æ®', 'error');
                return;
            }
            
            const dataStr = JSON.stringify(wordsData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'words.json';
            link.click();
            
            URL.revokeObjectURL(url);
            showStatus('âœ… æ•°æ®å¯¼å‡ºæˆåŠŸï¼', 'success');
        }

        // ç”Ÿæˆç¤ºä¾‹æ•°æ®
        function generateSampleData() {
            const sampleWords = [
                {
                    word: "cat",
                    definition: "A small animal with fur, four legs, and a tail that people keep as a pet.",
                    audioText: "A small furry animal with four legs and a tail. People keep it as a pet.",
                    difficulty: "easy",
                    options: ["dog", "cat", "bird", "fish"],
                    answer: "cat",
                    hint: "C _ _"
                },
                {
                    word: "sun",
                    definition: "The bright, hot thing in the sky that gives us light and warmth.",
                    audioText: "The bright hot thing in the sky. It gives us light and makes us warm.",
                    difficulty: "easy",
                    options: ["moon", "star", "sun", "cloud"],
                    answer: "sun",
                    hint: "S _ _"
                },
                {
                    word: "happy",
                    definition: "Feeling good and smiling when something nice happens.",
                    audioText: "When you feel good and smile because something nice happened to you.",
                    difficulty: "medium",
                    options: ["sad", "happy", "angry", "tired"],
                    answer: "happy",
                    hint: "H _ _ _ _"
                }
            ];
            
            wordsData = {
                words: sampleWords,
                questionTypes: [
                    { id: "text", name: "æ–‡å­—é¢˜å¹²", description: "åœ¨å±å¹•ä¸Šæ˜¾ç¤ºé¢˜ç›®æè¿°" },
                    { id: "audio", name: "éŸ³é¢‘é¢˜å¹²", description: "é€šè¿‡è¯­éŸ³æœ—è¯»é¢˜ç›®æè¿°" }
                ],
                answerTypes: [
                    { id: "choice", name: "é€‰æ‹©é¢˜", description: "ä»å¤šä¸ªé€‰é¡¹ä¸­é€‰æ‹©æ­£ç¡®ç­”æ¡ˆ" },
                    { id: "fill", name: "å¡«ç©ºé¢˜", description: "æ ¹æ®æç¤ºå¡«å†™å®Œæ•´å•è¯" }
                ],
                difficultyLevels: [
                    { id: "easy", name: "ç®€å•", color: "#4CAF50" },
                    { id: "medium", name: "ä¸­ç­‰", color: "#FF9800" },
                    { id: "hard", name: "å›°éš¾", color: "#F44336" }
                ]
            };
            
            renderWordList();
            showStatus('âœ… ç¤ºä¾‹æ•°æ®ç”ŸæˆæˆåŠŸï¼', 'success');
        }
    </script>
</body>
</html>