# 实施计划

- [x] 1. 创建新的API集成和数据类型


  - 在 `src/utils/supabaseApi.ts` 中添加 `get_homepage_data` RPC函数调用
  - 在 `src/types/index.ts` 中定义 `HomepageGameData` 和相关类型
  - 更新 `useAppStore` 添加 `loadHomepageData` 方法
  - _需求: 2.3, 3.1_

- [ ]* 1.1 为API集成编写属性测试
  - **属性 6: 默认教材选择**
  - **验证: 需求 2.3**

- [x] 2. 创建进度条组件


  - 创建 `src/components/ProgressBar.tsx` 组件
  - 实现三色进度条渲染逻辑（深绿色/浅绿色/灰色）
  - 添加适合儿童的UI样式（圆角、过渡效果）
  - _需求: 3.1, 3.2, 3.3, 3.4, 3.5, 5.3_

- [ ]* 2.1 为进度条组件编写属性测试
  - **属性 9: 进度条渲染**
  - **验证: 需求 3.1**

- [ ]* 2.2 为进度条颜色编写属性测试
  - **属性 10: 进度条颜色正确性**
  - **验证: 需求 3.2, 3.3, 3.4**

- [ ]* 2.3 为进度条纯图形化编写属性测试
  - **属性 11: 进度条纯图形化**
  - **验证: 需求 3.5**

- [x] 3. 创建教材选择器组件


  - 创建 `src/components/TextbookSelector.tsx` 组件
  - 实现点击显示下拉菜单功能
  - 添加外部点击关闭菜单逻辑
  - 实现教材切换和设置更新
  - 应用儿童友好的UI样式
  - _需求: 4.1, 4.2, 4.3, 4.4, 4.5_

- [ ]* 3.1 为教材选择交互编写属性测试
  - **属性 12: 教材选择交互**
  - **验证: 需求 4.1**

- [ ]* 3.2 为教材切换更新编写属性测试
  - **属性 13: 教材切换更新**
  - **验证: 需求 4.2**

- [ ]* 3.3 为进度数据刷新编写属性测试
  - **属性 14: 进度数据刷新**
  - **验证: 需求 4.3**

- [ ]* 3.4 为菜单外部点击关闭编写属性测试
  - **属性 15: 菜单外部点击关闭**
  - **验证: 需求 4.4**

- [x] 4. 优化HomePage组件


  - 修改 `src/components/HomePage.tsx` 移除冗余信息显示
  - 集成新的API调用 `loadHomepageData`
  - 添加教材信息和进度条到游戏卡片
  - 保持现有卡片尺寸和布局
  - _需求: 1.1, 1.2, 1.3, 1.5, 2.1, 2.2_

- [ ]* 4.1 为冗余信息移除编写属性测试
  - **属性 1: 冗余信息移除**
  - **验证: 需求 1.1, 1.2**

- [ ]* 4.2 为卡片尺寸保持编写属性测试
  - **属性 2: 卡片尺寸保持**
  - **验证: 需求 1.3**

- [ ]* 4.3 为布局元素对齐编写属性测试
  - **属性 3: 布局元素对齐**
  - **验证: 需求 1.5**

- [ ]* 4.4 为教材名称显示编写属性测试
  - **属性 4: 教材名称显示**
  - **验证: 需求 2.1**

- [ ]* 4.5 为教材信息限制编写属性测试
  - **属性 5: 教材信息限制**
  - **验证: 需求 2.2**

- [x] 5. 添加错误处理和加载状态


  - 在各组件中添加数据获取失败的错误处理
  - 实现加载状态的优雅显示
  - 添加数据不可用时的后备内容
  - _需求: 2.4, 2.5_

- [ ]* 5.1 为加载状态布局稳定性编写属性测试
  - **属性 7: 加载状态布局稳定性**
  - **验证: 需求 2.4**

- [ ]* 5.2 为数据不可用后备处理编写属性测试
  - **属性 8: 数据不可用后备处理**
  - **验证: 需求 2.5**

- [x] 6. 确保UI风格一致性


  - 验证所有新组件使用现有的设计系统样式
  - 确保颜色方案、字体和交互效果的一致性
  - 测试响应式布局和动画效果
  - _需求: 5.1, 5.2, 5.4_

- [ ]* 6.1 为儿童UI风格保持编写属性测试
  - **属性 16: 儿童UI风格保持**
  - **验证: 需求 5.1, 5.2, 5.4**

- [ ]* 6.2 为进度条样式一致性编写属性测试
  - **属性 17: 进度条样式一致性**
  - **验证: 需求 5.3**

- [x] 7. 检查点 - 确保所有测试通过


  - 确保所有测试通过，如有问题请询问用户

- [x] 8. 集成测试和最终验证



  - 测试完整的用户交互流程
  - 验证教材切换后进度数据正确更新
  - 确认所有功能在不同屏幕尺寸下正常工作
  - 验证与现有功能的兼容性
  - _需求: 全部_

- [ ]* 8.1 编写集成测试
  - 测试从首页数据加载到教材切换的完整流程
  - 验证状态管理的一致性
  - 测试错误恢复机制